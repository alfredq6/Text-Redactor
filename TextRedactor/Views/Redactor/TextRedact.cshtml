@model TextRedactViewModel

<link href="~/css/redactor.css" rel="stylesheet" />

<div class="container flex-container" style="margin-top: 200px;">
    <div>
        <textarea class="form-control" placeholder="Enter something" rows="5"></textarea>
    </div>
    <button class="btn btn-info" id="btn-suc">Detect</button><br />
    <div>
        <div id="correct_text"></div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous"></script>
<script>
    $(document).ready(() => {
        $('#btn-suc').click(() => {
            var correct_words = [];
            let words = $('textarea').val().toString().replace(/[!"#$%&'()*+,-./:;<=>?[\]^_`{|}~0123456789]/g, " ").split(" ");
            for (let i = 0; i < words.length; i++) {
                if (words[i].length >= 4) {
                    correct_words.push(words[i]);
                }
            }
            $.ajax({
                type: 'POST',
                data: { words: correct_words },
                url: '/Redactor/DetectLanguages',
                async: true,
                success: function (result) {
                    let correct_words_view = "";
                    for (let i = 0; i < result.length; i++) {
                        let languages_list = "<ul>";
                        for (let j = 0; j < result[i].languages.length; j++) {
                            languages_list += "<li>" + result[i].languages[j].language + " - " + result[i].languages[j].confidence + "%</li>";
                        }
                        languages_list += "</ul>"
                        correct_words_view += ("<span class='word'>" + result[i].text + " <span class='popup' style='display: none'>" + languages_list + "</span></span>");
                    }
                    $('#correct_text').html(correct_words_view);
                }
            })
        });
        $("#correct_text").delegate('.word', 'mouseenter', function () {
            $(this).children('.popup').toggle('fast');
        });
        $("#correct_text").delegate('.word', 'mouseleave', function () {
            $(this).children('.popup').toggle('fast');
        });
    });
</script>